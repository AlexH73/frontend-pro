# useEffect()

Хук Реакта, позволяет выполнять побочные эффекты на одном из этапов жизненного цикла компонента.

-   Принимает: callback-функцию и массив зависимостей
-   Возвращает: ничего

Callback-функция может возвращать любую другую функцию, которая будет выполнена сразу перед размонтированием компонента.

useEffect - это функция отложенного типа.

```tsx
    useEffect(() => {
        // какая-то функция-эффект

        return () => {
       // функция очистки эффекта
        }
    }, [/* массив зависимостей */])
```

Массив зависимостей:

-   если нет - эффект запускается при каждой отрисовке
-   если пустой \[\] - эффект сработает только при первом рендере
-   если есть зависимости \[...\] - эффект сработает при первом рендере и при изменении переменных, от которых он зависит

Еще пример с async await:

```tsx
 useEffect(() => {
        async function loadGender(): Promise<void> {
            const response = await fetch(`https://api.genderize.io?name=${firstName}`);
            const object = await response.json();
            // console.log(object); // {count: 14512, gender: 'female', name: 'sasha', probability: 0.52}
            setGender(object.gender)
        }
        console.log("use effect gender");
        loadGender()
    },[firstName])
```

## Полезные ссылки

-   Общая информация про useEffect и useRef с примерами [ссылка](https://www.w3schools.com/react/react_useeffect.asp)
-   Видео Минина про useEffect на примере to-do list [ссылка](https://www.youtube.com/watch?v=hwPo6OLBbD8)
-   Видео Минина про все хуки [ссылка](https://www.youtube.com/watch?v=9KJxaFHotqI)
-   Сайт с бесплатной Api [ссылка](https://genderize.io/)
-   Сайт с генерацией Api вашего формата [ссылка](https://designer.mocky.io/)

## **1\. Жизненный Цикл Компонентов в React**

Жизненный цикл компонента описывает этапы, которые компонент проходит с момента создания до удаления. Эти этапы важны для понимания работы React и управления состоянием и побочными эффектами.

### **Этапы жизненного цикла:**

1.  **Монтирование (Mounting):**
    
    -   Компонент создаётся и добавляется в DOM.
    -   В функциональных компонентах используется `useEffect` с пустым массивом зависимостей `[]`.
2.  **Обновление (Updating):**
    
    -   Происходит при изменении пропсов или состояния.
    -   В функциональных компонентах это достигается через `useEffect` с зависимостями.
3.  **Размонтирование (Unmounting):**
    
    -   Компонент удаляется из DOM.
    -   В функциональных компонентах можно использовать `useEffect` с функцией очистки.

___

## **2\. Хук `useEffect`**

`useEffect` — это хук в функциональных компонентах, который позволяет выполнять побочные эффекты, такие как:

-   Загрузка данных.
-   Подписка на события.

### **Синтаксис:**

```tsx
useEffect(() => {
  // Код эффекта
  return () => {
    // Очистка эффекта
  };
}, [dependencies]); // Массив зависимостей
```

### **Поведение `useEffect`:**

1.  **Без зависимостей (`[]`):**
    
    -   Код выполняется **один раз** при монтировании компонента.

    ```tsx
    useEffect(() => {
      console.log("Компонент смонтирован!");
    }, []);
    ```
    
2.  **С зависимостями:**
    
    -   Код выполняется при изменении указанных зависимостей.
    
    ```tsx
    useEffect(() => {
      console.log("Значение изменилось!");
    }, [dependency]);
    ```
    
3.  **С очисткой:**
    
    -   Очистка выполняется перед удалением компонента или перед следующим вызовом эффекта.
    
    ```tsx
    useEffect(() => {
      const timer = setInterval(() => console.log("Таймер работает"), 1000);
      return () => clearInterval(timer); // Очистка
    }, []);
    ```
