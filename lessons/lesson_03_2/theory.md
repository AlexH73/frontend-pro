# Что такое состояние в React?

Состояние (state) — это способ хранить и управлять данными, которые могут изменяться в течение времени и влияют на то, как компонент отображается. Оно позволяет компоненту быть **динамическим**: обновлять интерфейс в ответ на действия пользователя, сетевые запросы, таймеры и другие события.

___

### Почему состояние важно?

Состояние позволяет:

1.  **Реагировать на изменения данных**. Например, если пользователь нажимает на кнопку "увеличить счетчик", значение счетчика изменяется, и интерфейс обновляется.
    
2.  **Синхронизировать UI с данными**. Если данные меняются, React автоматически обновляет соответствующую часть интерфейса. Вы не пишете код, который вручную перерисовывает элемент.
    
3.  **Изолировать логику компонента**. Каждый компонент может иметь своё локальное состояние, что делает приложение более структурированным.
    

___

### Почему нельзя использовать обычные переменные?

На первый взгляд, кажется, что можно просто использовать обычные переменные для хранения данных:

```tsx
let count = 0;

function increment() {
  count += 1;
  console.log(count);
}
```

Однако у этого подхода есть несколько проблем:

#### 1\. **Изменение переменных не вызывает обновление интерфейса**

Когда значение обычной переменной изменяется, React не знает об этом. Интерфейс не обновится автоматически:

```tsx
let count = 0;

function App() {
  function increment() {
    count += 1;
    console.log(count); // Выводится в консоль, но на экране ничего не меняется
  }

  return (
    <div>
      <h1>Count: {count}</h1>
      <button onClick={increment}>Increment</button>
    </div>
  );
}
```

При изменении переменной `count` React не понимает, что нужно перерисовать компонент.

___

#### 2\. **Состояние "привязывается" к жизненному циклу компонента**

Обычные переменные не сохраняются при повторном рендере компонента. Каждый раз, когда компонент перерисовывается, переменные будут сбрасываться:

```tsx
function App() {
  let count = 0; // Сбрасывается при каждом рендере

  function increment() {
    count += 1;
    console.log(count); // Всегда будет считать с нуля
  }

  return (
    <div>
      <h1>Count: {count}</h1>
      <button onClick={increment}>Increment</button>
    </div>
  );
}
```

___

#### 3\. **Отсутствие контроля и предсказуемости**

React использует специальный механизм для управления состоянием, который гарантирует, что обновления будут выполнены корректно, даже при асинхронных операциях. Если использовать обычные переменные, сложно контролировать, в каком порядке обновляются данные и интерфейс.

___

### Как работает состояние?

Вместо использования обычных переменных, React предоставляет специальный механизм — **состояние**. С помощью хука `useState` вы можете:

1.  **Инициализировать состояние**. Например:
    
    ```tsx
    const [count, setCount] = useState(0);
    ```
    
    -   `count` — текущее значение состояния.
    -   `setCount` — функция, которая изменяет значение `count`.
    -   `0` — начальное значение состояния.
2.  **Обновлять состояние**. Например, увеличивать значение счетчика:
    
    ```tsx
    const increment = () => setCount(count + 1);
    ```
    
3.  **Синхронизировать интерфейс**. React автоматически обновляет компонент, когда изменяется состояние:
    

#### Что такое `useState`

`useState` — это хук в React, который позволяет функциональным компонентам управлять состоянием.

___

#### Как работает `useState`

`useState` возвращает массив из двух элементов:

1.  **Переменная состояния** (в данном случае `count`) — содержит текущее значение состояния.
2.  **Функция для обновления состояния** (в данном случае `setCount`) — используется для изменения значения состояния.

Синтаксис:

```tsx
const [state, setState] = useState(initialValue);
```

-   `state` — текущее значение состояния.
-   `setState` — функция, вызываемая для обновления состояния.
-   `initialValue` — начальное значение состояния (в примере это `0`).

___

#### Пример работы

1.  **Инициализация состояния**:
    
    ```tsx
    const [count, setCount] = useState(0);
    ```
    
    Здесь:
    
    -   `count` — текущее значение состояния.
    -   `setCount` — функция, которая обновляет `count`.
    -   `0` — начальное значение `count`.
2.  **Изменение состояния**: Чтобы изменить состояние, вызывается функция `setCount`. Она принимает новое значение состояния или функцию, возвращающую новое значение на основе предыдущего состояния:
    
    ```tsx
    const increment = () => setCount(count + 1); // Увеличение на 1
    const decrement = () => setCount(count - 1); // Уменьшение на 1
    ```
    
3.  **Отображение состояния**: Значение состояния отображается в JSX:
    

___

#### Особенности `useState`

1.  **Асинхронность обновлений**:
    
    -   Обновление состояния с помощью `setCount` происходит асинхронно.
    -   Если нужно обновить состояние на основе предыдущего значения, используйте функцию:
        
        ```tsx
        setCount(prevCount => prevCount + 1);
        ```
        
2.  **Повторный рендеринг**:
    
    -   Изменение состояния вызывает повторный рендеринг компонента, чтобы отобразить новое значение.
3.  **Не изменяйте состояние напрямую**:
    
    -   Нельзя изменять переменную состояния напрямую (`count = 1` не сработает).
    -   Всегда используйте `setCount`.

___

#### Расширенный пример с обработкой событий

```tsx
function Counter() {
  const [count, setCount] = useState(0);

  const changeCount = (delta) => {
    setCount((prevCount) => prevCount + delta);
  };

  return (
    <div>
      <h1>Count: {count}</h1>
      <button onClick={() => changeCount(1)}>Increment</button>
      <button onClick={() => changeCount(-1)}>Decrement</button>
      <button onClick={() => setCount(0)}>Reset</button>
    </div>
  );
}
```

___

#### Также

1.  `useState` можно вызывать несколько раз в одном компоненте для управления несколькими состояниями:
    
    ```tsx
    const [count, setCount] = useState(0);
    const [name, setName] = useState("");
    ```
    
2.  Начальное значение может быть не только числом, но и строкой, объектом, массивом:
    
    ```tsx
    const [user, setUser] = useState({ name: "John", age: 25 });
    ```
    
3.  Состояние сохраняется при повторных рендерах, но сбрасывается при размонтировании компонента.
